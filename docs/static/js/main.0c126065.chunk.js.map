{"version":3,"sources":["serviceWorker.js","SituationBar.tsx","GoPosition.ts","GoBoard.tsx","Gtp.ts","GoAI.tsx","App.tsx","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","SituationBar","props","style","width","height","borderStyle","borderWidth","borderColor","marginBottom","blackStyle","float","textAlign","color","blackPercent","backgroundColor","whiteStyle","blackInfo","whiteInfo","opponentOf","coord2xy","coord","c","charCodeAt","parseInt","slice","xy2coord","x","y","Marker","boardSize","BOARD_SIZE","BOARD_SIZE2","value","marks","this","Int32Array","point","HANDICAPS","GoPosition","handicap","turn","ko","recent8","marker1","marker2","Float32Array","xy","setState","xyToPoint","undefined","source","result","set","sgf","jssgf","fastParse","root","p","SZ","node","_children","length","move","B","W","moveToXy","play","apply","s","offset","string","points","e","opponent","captives","adjacenciesAt","pt","getState","stringAt","liberties","removeString","push","GoString","clear","mark","index","isMarked","a","opponents","unshift","pop","putRecent8","switchTurn","captureBy","undoPlay","Math","floor","pointToXy","o","os","escape","ss","tryToCapture","canEscape","adjacencies","every","stack","likeEye","numBadDiagonal","allowableBadDiagonal","diagonalsAt","d","indexOf","isEyeOfTurn","GoIntersectionState","stone","number","winrate","playouts","fillColor","HSVtoRGB","h","v","r","g","b","i","f","q","t","round","RGBtoHSV","max","min","board2intersections","board","intersections","Array","intersection","range","start","end","GoBoard","w","key","onClick","onClickIntersection","onMouseEnter","onMouseEnterIntersection","onMouseLeave","onMouseLeaveIntersection","info","candidate","candidates","find","model","position","copy","pv","first","toFixed","visits","textColor","variationIntersections","rgb","maxPlayouts","map","maxWinrate","greenHue","cyanHue","entries","percentPlayouts","logPlayouts","hue","alpha","addCandidatesInfo","goBoardStyle","className","renderIntersection","includes","React","Component","GoIntersection","n","intersectionStyle","infoStyle","onTouchEnd","sprintf","setInterval","PureComponent","Gtp","url","callback","socket","buffer","lastCommand","resolve","reject","LzAnalyzeHandler","kataAnalyzeHandler","Module","WebSocket","onopen","event","onmessage","data","lines","split","line","process","onerror","err","setTimeout","CustomEvent","document","addEventListener","visibilityState","resume","suspend","str","send","Promise","res","rej","_command","command","interval","handler","startsWith","parseLzAnalyze","parseKataAnalyze","regex","exec","prior","lcb","order","ownership","trim","infos","infoStrs","shift","items","item","splice","parseFloat","appendScript","URL","onload","el","createElement","src","body","appendChild","updateMessage","dom","getElementById","innerText","GoAI","size","byoyomi","gtp","percent","black","white","history","clipboardData","getData","FS","writeFile","fromSgf","kataAnalyze","SharedArrayBuffer","goAI","target","toString","innerWidth","innerHeight","undo","lzAnalyze","blackWinrate","blackScore","scoreMean","scoreStdev","App","search","assigns","substr","tokens","render","href","origin","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.0c126065.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React from \"react\";\n\ninterface Props {\n    width: string;\n    blackPercent: number;\n    blackInfo: string;\n    whiteInfo: string;\n}\n\nfunction SituationBar(props: Props) {\n    const style = {\n        width: props.width,\n        height: \"15px\",\n        borderStyle: \"solid\",\n        borderWidth: \"1px\",\n        borderColor: \"black\",\n        marginBottom: \"5px\",\n    } as const;\n    const blackStyle = {\n        float: \"left\" as const,\n        textAlign: \"center\",\n        color: \"white\",\n        width: `${props.blackPercent}%`,\n        height: \"100%\",\n        backgroundColor: \"black\",\n    } as const;\n    const whiteStyle = {\n        float: \"left\",\n        textAlign: \"center\",\n        width: `${100 - props.blackPercent}%`,\n        height: \"100%\",\n    } as const;\n    return (\n        <div style={style}>\n        <div style={blackStyle}>{props.blackInfo}</div>\n        <div style={whiteStyle}>{props.whiteInfo}</div>\n        </div>\n    );\n}\n\nexport default SituationBar;","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport jssgf from \"jssgf\";\n\nexport const EMPTY = 0;\nexport const BLACK = 1;\nexport const WHITE = 2;\nconst PASS = -1;\n\ntype GoColor = 1 | 2; // BLACK, WHITE\ntype GoIntersectionState = 0 | 1 | 2; // EMPTY, BLACK, WHITE\n\nexport function opponentOf(color: GoColor): GoColor {\n    return color === BLACK ? WHITE : BLACK;\n}\n\nexport function coord2xy(coord: string): [number, number] {\n    const c = coord.charCodeAt(0);\n    const x = (c < \"I\".charCodeAt(0) ? c + 1 : c) - \"A\".charCodeAt(0);\n    return [x, parseInt(coord.slice(1))];\n}\n\nexport function xy2coord(x: number, y: number): string {\n    const COORD = [\"@\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\"];\n    return COORD[x] + y;\n}\n\nclass Marker {\n    BOARD_SIZE: number;\n    BOARD_SIZE2: number;\n    value: number;\n    marks: Int32Array;\n\n    constructor(boardSize: number) {\n        this.BOARD_SIZE = boardSize;\n        this.BOARD_SIZE2 = boardSize * boardSize;\n        this.value = 0;\n        this.marks = new Int32Array(this.BOARD_SIZE2);\n    }\n\n    clear() {\n        this.value += 1;\n    }\n\n    isMarked(point: number): boolean {\n        return this.marks[point] === this.value;\n    }\n\n    mark(point: number) {\n        this.marks[point] = this.value;\n    }\n}\n\nconst HANDICAPS = [\n    [],\n    [],\n    [[16, 4], [4, 16]],\n    [[16, 4], [4, 16], [16, 16]],\n    [[16, 4], [4, 16], [16, 16], [4, 4]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [10, 10]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10], [10, 10]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10], [10, 4], [10, 16]],\n    [[16, 4], [4, 16], [16, 16], [4, 4], [16, 10], [4, 10], [10, 4], [10, 16], [10, 10]],\n];\n\n\nexport interface GoMove {\n    turn: GoColor;\n    point: number;\n    ko?: number;\n    captives: number[];\n    string: GoString;\n}\n\nclass GoPosition {\n    BOARD_SIZE: number;\n    BOARD_SIZE2: number;\n    turn: GoColor;\n    state: { [name in GoColor]: Float32Array };\n    ko?: number;\n    recent8: number[];\n    marker1: Marker;\n    marker2: Marker;\n\n    static copy(source: GoPosition) {\n        const result = new GoPosition(source.BOARD_SIZE, 0);\n        result.state[BLACK].set(source.state[BLACK]);\n        result.state[WHITE].set(source.state[WHITE]);\n        result.turn = source.turn;\n        result.ko = source.ko;\n        return result;\n    }\n\n    static fromSgf(sgf: string) {\n        const [root] = jssgf.fastParse(sgf);\n        const p = new this(parseInt(root.SZ || \"19\"));\n        let node = root;\n        while (node._children.length > 0) {\n            node = node._children[0];\n            let move;\n            if (node.B != null) {\n                move = node.B;\n            } else if (node.W != null) {\n                move = node.W;\n            } else {\n                continue;\n            }\n            const xy = p.moveToXy(move);\n            if (xy === PASS) {\n                p.play(PASS);\n            } else {\n                p.play(p.xyToPoint.apply(p, xy));\n            }\n        }\n        return p\n    }\n\n    constructor(boardSize: number, handicap: number = 0) {\n        this.BOARD_SIZE = boardSize;\n        this.BOARD_SIZE2 = boardSize * boardSize;\n        this.state = {\n            [BLACK]: new Float32Array(this.BOARD_SIZE2),\n            [WHITE]: new Float32Array(this.BOARD_SIZE2)\n        }\n        this.recent8 = [];\n        this.marker1 = new Marker(boardSize);\n        this.marker2 = new Marker(boardSize);\n        if (handicap > 1) {\n            for (const xy of HANDICAPS[handicap]) {\n                this.setState(this.xyToPoint(xy[0], xy[1]), BLACK);\n            }\n            this.turn = WHITE;\n        } else {\n            this.turn = BLACK;\n        }\n        this.ko = undefined;\n    }\n\n    moveToXy(s: string): [number, number] | -1 {\n        if (s === \"\") {\n            return PASS;\n        }\n        const offset = \"a\".charCodeAt(0) - 1;\n        return [s.charCodeAt(0) - offset, this.BOARD_SIZE - (s.charCodeAt(1) - offset) + 1];\n    }\n    \n    \n    opponent() {\n        return opponentOf(this.turn);\n    }\n\n    switchTurn() {\n        this.turn = opponentOf(this.turn);\n    }\n\n    getState(point: number) {\n        if (this.state[BLACK][point] === 1.0) {\n            return BLACK;\n        }\n        if (this.state[WHITE][point] === 1.0) {\n            return WHITE;\n        }\n        return EMPTY;\n    }\n\n    setState(point: number, color: GoIntersectionState) {\n        if (color === EMPTY) {\n            this.state[BLACK][point] = 0.0;\n            this.state[WHITE][point] = 0.0;\n        } else {\n            this.state[color][point] = 1.0;\n        }\n    }\n\n    removeString(string: GoString) {\n        for (const e of string.points) {\n            this.setState(e, EMPTY);\n        }\n    }\n\n    captureBy(point: number): number[] {\n        const opponent = this.opponent();\n        const captives: number[] = [];\n        for (const pt of this.adjacenciesAt(point)) {\n            if (this.getState(pt) === opponent) {\n                const string = this.stringAt(pt);\n                if (string != null && string.liberties.length === 0) {\n                    this.removeString(string);\n                    captives.push.apply(captives, string.points);\n                }\n            }\n        }\n        return captives;\n    }\n\n    stringAt(point: number): GoString | undefined {\n        const color = this.getState(point);\n        if (color === EMPTY) {\n            return undefined;\n        }\n        const opponent = opponentOf(color);\n        const string = new GoString();\n\n        this.marker1.clear();\n        this.marker2.clear();\n        string.points.push(point);\n        this.marker2.mark(point);\n        for (let index = 0; index < string.points.length; index++) {\n            const pt = string.points[index];\n            if (!this.marker1.isMarked(pt)) {\n                this.marker1.mark(pt);\n                for (const a of this.adjacenciesAt(pt)) {\n                    if (!this.marker1.isMarked(a)) {\n                        const state = this.getState(a);\n                        if (state === color) {\n                            if (!this.marker2.isMarked(a)) {\n                                string.points.push(a);\n                                this.marker2.mark(a);\n                            }\n                        } else {\n                            this.marker1.mark(a);\n                            if (state === opponent) {\n                                string.opponents.push(a);\n                            } else {\n                                string.liberties.push(a);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return string;\n    }\n\n    putRecent8(point: number) {\n        this.recent8.unshift(point);\n        if (this.recent8.length > 8) {\n            this.recent8.pop();\n        }\n    }\n\n    play(point: number): GoMove | undefined {\n        if (point === PASS) {\n            this.putRecent8(point);\n            this.switchTurn();\n            return {\n                turn: this.turn,\n                point,\n                ko: this.ko,\n                captives: [],\n                string: new GoString()\n            };\n        }\n        if (point === this.ko || this.getState(point) !== EMPTY) { // 着手禁止\n            return undefined;\n        }\n        this.setState(point, this.turn);\n\n        const captives = this.captureBy(point);\n        const string = this.stringAt(point)!;\n        const liberties = string.liberties.length;\n        if (liberties === 0) { // 着手禁止\n            this.setState(point, EMPTY); // restore\n            return undefined;\n        }\n        const ko = this.ko;\n        if (captives.length === 1 && liberties === 1 && string.points.length === 1) {\n            this.ko = string.liberties[0];\n        } else {\n            this.ko = undefined;\n        }\n        this.putRecent8(point);\n        const turn = this.turn;\n        this.switchTurn();\n        return { turn, point, ko, captives, string };\n    }\n\n    undoPlay(move: GoMove) {\n        this.ko = move.ko;\n        this.switchTurn();\n        if (move.point === PASS) {\n            return;\n        }\n        this.setState(move.point, EMPTY);\n        const opponent = opponentOf(move.turn);\n        for (const p of move.captives) {\n            this.setState(p, opponent);\n        }\n    }\n\n    isLegal(point: number): boolean {\n        const move = this.play(point);\n        if (move) {\n            this.undoPlay(move);\n            return true;\n        }\n        return false;\n    }\n\n    xyToPoint(x: number, y: number): number {\n        return (x - 1) + (y - 1) * this.BOARD_SIZE;\n    }\n\n    pointToXy(point: number): [number, number] {\n        const y = Math.floor(point / this.BOARD_SIZE);\n        const x = point - y * this.BOARD_SIZE;\n        return [x + 1, y + 1];\n    }\n\n    adjacenciesAt(point: number): number[] {\n        const xy = this.pointToXy(point);\n        const result = [];\n        for (const e of [[0, -1], [-1, 0], [1, 0], [0, 1]]) {\n            const x = xy[0] + e[0];\n            const y = xy[1] + e[1];\n            if (x >= 1 && x <= this.BOARD_SIZE && y >= 1 && y <= this.BOARD_SIZE) {\n                result.push(this.xyToPoint(x, y));\n            }\n        }\n        return result;\n    }\n\n    diagonalsAt(point: number) {\n        const xy = this.pointToXy(point);\n        const result = [];\n        for (const e of [[-1, -1], [-1, 1], [1, -1], [1, -1]]) {\n            const x = xy[0] + e[0];\n            const y = xy[1] + e[1];\n            if (x >= 1 && x <= this.BOARD_SIZE && y >= 1 && y <= this.BOARD_SIZE) {\n                result.push(this.xyToPoint(x, y));\n            }\n        }\n        return result;\n    }\n\n    canEscape(string: GoString): boolean {\n        if (string.liberties.length > 1) { // アタリじゃない\n            return true;\n        }\n        for (const o of string.opponents) { // 相手の石を取って逃げる\n            const os = this.stringAt(o)!;\n            if (os.liberties.length === 1) { // アタリの石\n                const escape = this.play(os.liberties[0]);\n                if (!escape) { // 着手禁止\n                    continue;\n                }\n                const ss = this.stringAt(string.points[0])!; // stringの更新\n                if (ss.liberties.length === 2) { // 取ってもまだシチョウ\n                    for (const o of ss.liberties) {\n                        const tryToCapture = this.play(o);\n                        if (!tryToCapture) {\n                            continue;\n                        }\n                        const result = this.canEscape(this.stringAt(ss.points[0])!);\n                        this.undoPlay(tryToCapture);\n                        if (!result) {\n                            this.undoPlay(escape);\n                            return false;\n                        }\n                    }\n                    this.undoPlay(escape);\n                    return true;\n                } else {\n                    this.undoPlay(escape);\n                    return ss.liberties.length > 2;\n                }\n            }\n        }\n        const escape = this.play(string.liberties[0]);\n        if (escape == null) {\n            return false;\n        }\n        if (escape.string != null && escape.string.liberties.length === 2) {\n            for (const o of escape.string.liberties) {\n                const tryToCapture = this.play(o);\n                if (!tryToCapture) {\n                    continue;\n                }\n                const ss = this.stringAt(string.points[0])!;\n                const result = this.canEscape(ss);\n                this.undoPlay(tryToCapture);\n                if (!result) {\n                    this.undoPlay(escape);\n                    return false;\n                }\n            }\n            this.undoPlay(escape);\n            return true;\n        } else {\n            this.undoPlay(escape);\n            return escape.string.liberties.length !== 1;\n        }\n    }\n\n    likeEye(point: number): boolean {\n        if (this.getState(point) !== EMPTY) {\n            return false;\n        }\n        const adjacencies = this.adjacenciesAt(point);\n        if (!adjacencies.every(p => this.getState(p) === this.turn)) {\n            return false;\n        }\n        return adjacencies.every(p => this.stringAt(p)!.liberties.length > 1);\n    }\n\n    isEyeOfTurn(point: number, stack: number[] = []): boolean {\n        if (!this.likeEye(point)) {\n            return false;\n        }\n        let numBadDiagonal = 0;\n        const allowableBadDiagonal = this.adjacenciesAt(point).length === 4 ? 1 : 0;\n\n        const opponent = opponentOf(this.turn);\n        for (const d of this.diagonalsAt(point)) {\n            if (this.getState(d) === opponent) {\n                numBadDiagonal += 1;\n            } else if (this.getState(d) === EMPTY && stack.indexOf(d) < 0) {\n                stack.push(point);\n                if (!this.isEyeOfTurn(d, stack)) {\n                    numBadDiagonal += 1;\n                }\n                stack.pop();\n            }\n            if (numBadDiagonal > allowableBadDiagonal) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    isFalseEye(point: number): boolean {\n        return this.likeEye(point) && !this.isEyeOfTurn(point);\n    }\n\n    toString(): string {\n        let string =\"\";\n        for (let y = 1; y <= this.BOARD_SIZE; y++) {\n            for (let x = 1; x <= this.BOARD_SIZE; x++) {\n                switch (this.getState(this.xyToPoint(x, y))) {\n                    case EMPTY:\n                        string += \".\";\n                        break;\n                    case BLACK:\n                        string += \"X\";\n                        break;\n                    case WHITE:\n                        string += \"O\";\n                        break;\n                    default:\n                }\n            }\n            string += \"\\n\";\n        }\n        return string;\n    }\n}\n\nclass GoString {\n    points: number[];\n    liberties: number[];\n    opponents: number[];\n    constructor() {\n        this.points = [];\n        this.liberties = [];\n        this.opponents = [];\n    }\n}\n\nexport default GoPosition;","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React, { CSSProperties } from \"react\";\nimport \"./GoBoard.css\";\nimport { sprintf } from \"sprintf-js\";\nimport { KataInfo } from \"./Gtp\";\nimport GoPosition, { BLACK, WHITE, opponentOf, coord2xy, xy2coord } from \"./GoPosition\";\n\ntype RGB = {\n    r: number,\n    g: number,\n    b: number,\n}\n\nclass GoIntersectionState {\n    stone?: string;\n    number?: number;\n    winrate?: string;\n    playouts?: number;\n    fillColor?: string;\n    borderWidth?: string;\n    borderColor?: string;\n    backgroundColor?: string;\n\n    constructor() {\n        this.stone = undefined;\n        this.number = undefined;\n        this.winrate = undefined;\n        this.playouts = undefined;\n        this.fillColor = undefined;\n        this.borderWidth = undefined;\n        this.borderColor = undefined;\n        this.backgroundColor = undefined;\n    }\n}\n\n/* accepts parameters\n * h  Object = {h:x, s:y, v:z}\n * OR \n * h, s, v\n*/\nfunction HSVtoRGB(h: number, s: number, v: number): RGB {\n    let r, g, b, i, f, p, q, t;\n    i = Math.floor(h * 6);\n    f = h * 6 - i;\n    p = v * (1 - s);\n    q = v * (1 - f * s);\n    t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n        case 0:\n        r = v;\n        g = t;\n        b = p;\n        break;\n        case 1: r = q;\n        g = v;\n        b = p;\n        break;\n        case 2:\n        r = p;\n        g = v;\n        b = t;\n        break;\n        case 3:\n        r = p;\n        g = q;\n        b = v;\n        break;\n        case 4:\n        r = t;\n        g = p;\n        b = v;\n        break;\n        default: // 5\n        r = v;\n        g = p;\n        b = q;\n        break;\n    }\n    return {\n        r: Math.round(r * 255),\n        g: Math.round(g * 255),\n        b: Math.round(b * 255)\n    };\n}\n\n/* accepts parameters\n * r  Object = {r:x, g:y, b:z}\n * OR \n * r, g, b\n*/\nfunction RGBtoHSV(r: number, g: number, b: number): { h: number, s: number, v: number } {\n    let max = Math.max(r, g, b);\n    let min = Math.min(r, g, b);\n    let d = max - min;\n    let h;\n    let s = (max === 0 ? 0 : d / max);\n    let v = max / 255;\n\n    switch (max) {\n        case min:\n        h = 0;\n        break;\n        case r:\n        h = (g - b) + d * (g < b ? 6: 0);\n        h /= 6 * d;\n        break;\n        case g:\n        h = (b - r) + d * 2;\n        h /= 6 * d;\n        break;\n        default: // case b:\n        h = (r - g) + d * 4;\n        h /= 6 * d;\n        break;\n    }\n\n    return {\n        h: h,\n        s: s,\n        v: v\n    };\n}\n\nfunction darker(rgb: RGB): RGB {\n    const ratio = 0.7;\n    const r = rgb.r;\n    const g = rgb.g;\n    const b = rgb.b;\n    return {\n        r: r * ratio,\n        g: g * ratio,\n        b: b * ratio,\n    }\n}\n\nfunction shortStringOfInteger(n: number): string {\n    if (n < 1000) {\n        return sprintf(\"%d\", n);\n    } else if (n < 10000) {\n        return sprintf(\"%.1fk\", n / 1000);\n    } else if (n < 1000000) {\n        return sprintf(\"%.0fk\", n / 1000);\n    } else if (n < 10000000) {\n        return sprintf(\"%.1fM\", n / 1000000);\n    } else if (n < 1000000000) {\n        return sprintf(\"%.0fM\", n / 1000000);\n    } else {\n        return sprintf(\"%.0G\", n / 1000000000);\n    }\n}\n\nexport function board2intersections(board: GoPosition) {\n    const intersections = new Array(board.BOARD_SIZE2);\n    for (let i = 0; i < intersections.length; i++) {\n        const intersection  = new GoIntersectionState();\n        switch (board.getState(i)) {\n            case BLACK:\n            intersection.stone = \"B\";\n            break;\n            case WHITE:\n            intersection.stone = \"W\";\n            break;\n            default:\n        }\n        intersections[i] = intersection;\n    }\n    return intersections;\n}\n\nfunction addCandidatesInfo(intersections: GoIntersectionState[], model: GoPosition, candidates: KataInfo[]) {\n    const maxPlayouts = Math.max(...candidates.map(e => e.visits));\n    const maxWinrate = Math.max(...candidates.map(e => e.winrate));\n    const saturation = 0.75;\n    const brightness = 0.85;\n    const maxAlpha = 240;\n    const minAlpha = 32;\n    const hueFactor = 3.0;\n    const alphaFactor = 5.0;\n    const greenHue = RGBtoHSV(0, 255, 0).h;\n    const cyanHue = RGBtoHSV(0, 255, 255).h;\n    for (const [i, candidate] of candidates.entries()) {\n        const intersection = intersections[model.xyToPoint.apply(model, coord2xy(candidate.move))];\n        intersection.winrate = (candidate.winrate * 100).toFixed(1);\n        intersection.playouts = candidate.visits;\n\n        const percentPlayouts = intersection.playouts / maxPlayouts;\n        const logPlayouts = Math.log(percentPlayouts);\n        const hue = i === 0 ?  cyanHue : greenHue * Math.max(0, logPlayouts / hueFactor + 1);\n        const alpha = ((minAlpha + (maxAlpha - minAlpha) * Math.max(0, logPlayouts / alphaFactor + 1))) / 255;\n        const color = HSVtoRGB(hue, saturation, brightness);\n        if (i === 0) {\n            if (candidate.winrate < maxWinrate) {\n                intersection.borderWidth = \"2px\";\n                intersection.borderColor = \"red\";\n            } else {\n                intersection.borderWidth = \"1px\";\n                const c = darker(color);\n                intersection.borderColor = `rgba(${c.r},${c.g},${c.b},${alpha})`;\n            }\n        } else if (intersection.winrate === maxWinrate.toFixed(1)) {\n            intersection.borderWidth = \"2px\";\n            intersection.borderColor = \"blue\";\n        }\n        intersection.fillColor = `rgba(${color.r},${color.g},${color.b},${alpha})`;\n    }\n}\n\nfunction variationIntersections(model: GoPosition, info: KataInfo): GoIntersectionState[] {\n    const position = GoPosition.copy(model);\n    for (const move of info.pv) {\n        position.play(position.xyToPoint.apply(position, coord2xy(move)));\n    }\n    const intersections = board2intersections(position);\n    let turn = model.turn;\n    const first = intersections[position.xyToPoint.apply(position, coord2xy(info.move))];\n    first.winrate = info.winrate.toFixed(1);\n    first.playouts = info.visits;\n    first.textColor = turn === BLACK ? \"white\" : \"black\";\n    let number = 2;\n    turn = opponentOf(turn);\n    for (const move of info.pv.slice(1)) {\n        const intersection = intersections[position.xyToPoint.apply(position, coord2xy(move))]\n        intersection.number = number;\n        intersection.textColor = turn === BLACK ? \"white\" : \"black\";\n        turn = opponentOf(turn);\n        number++;\n    }\n    return intersections;\n}\n\nfunction addOwnership(intersections: GoIntersectionState[], model: GoPosition, ownership: number[]) {\n    if (model.turn === BLACK) {\n        for (const [i, v] of ownership.entries()) {\n            if (i >= model.BOARD_SIZE2) {\n                break;\n            }\n            const value = v * 0.5;\n            const [x, y] = model.pointToXy(i);\n            const intersection = intersections[model.BOARD_SIZE * (model.BOARD_SIZE - y) + (x - 1)];\n            intersection.backgroundColor = value > 0.0 ? `rgba(0,0,0,${value})` : `rgba(255,255,255,${-value})`;\n        }\n    } else {\n        for (const [i, value] of ownership.entries()) {\n            if (i >= model.BOARD_SIZE2) {\n                break;\n            }\n            const [x, y] = model.pointToXy(i);\n            const intersection = intersections[model.BOARD_SIZE * (model.BOARD_SIZE - y) + (x - 1)];\n            intersection.backgroundColor = value < 0.0 ? `rgba(0,0,0,${-value})` : `rgba(255,255,255,${value})`;\n        }\n    }\n}\n\nfunction range(start: number, end: number): number[] {\n    const result = [];\n    if (start <= end) {\n        for (let i = start; i <= end; i++) {\n            result.push(i);\n        }\n    } else {\n        for (let i = start; i >= end; i--) {\n            result.push(i);\n        }\n    }\n    return result;\n}\n\ninterface GoBoardProps {\n    width: string;\n    height: string;\n    w: number;\n    h: number;\n    model: GoPosition;\n    candidates: KataInfo[];\n    onClickIntersection: (x: number, y: number) => void,\n}\n\ninterface GoBoardState {\n    candidate?: string;\n}\n\nclass GoBoard extends React.Component<GoBoardProps, GoBoardState>  {\n    constructor(props: GoBoardProps) {\n        super(props);\n        this.state = {}\n    }\n\n    index(x: number, y: number): number {\n        return this.props.w * (y - 1) + x - 1;\n    }\n\n    /*, number, winrate, visits, backgroundColor, borderColor) {\n\n    }*/\n\n    renderIntersection(intersections: GoIntersectionState[], x: number, y: number) {\n        const intersection = intersections[this.index(x, y)];\n        return (\n            <GoIntersection\n                key={`${x}-${y}`}\n                onClick={() => this.props.onClickIntersection(x, y)}\n                onMouseEnter={() => this.onMouseEnterIntersection(x, y)}\n                onMouseLeave={() => this.onMouseLeaveIntersection(x, y)}\n                stone={intersection.stone}\n                number={intersection.number}\n                winrate={intersection.winrate}\n                playouts={intersection.playouts}\n                fillColor={intersection.fillColor}\n                borderWidth={intersection.borderWidth}\n                borderColor={intersection.borderColor}\n                backgroundColor={intersection.backgroundColor}\n            />\n        );\n    }\n\n    render() {\n        let intersections: GoIntersectionState[];\n        let info: KataInfo | undefined;\n        if (this.state.candidate) {\n            info = this.props.candidates.find(e => e.move === this.state.candidate);\n            if (info != null) {\n                intersections = variationIntersections(this.props.model, info);\n            }\n        }\n        if (info == null) {\n            intersections = board2intersections(this.props.model);\n            if (this.props.candidates) {\n                addCandidatesInfo(intersections, this.props.model, this.props.candidates);\n            }\n        }\n        const goBoardStyle = {\n            width: this.props.width,\n            height: this.props.height,\n        };\n        return (\n            <div className=\"go-board\" style={goBoardStyle}>\n            <div className=\"go-board-content\">\n                {range(this.props.h, 1).map(y => (\n                    <div className=\"go-row\" key={y}>\n                        {range(1, this.props.w).map(x => this.renderIntersection(intersections, x, y))}\n                    </div>\n                ))}\n            </div>\n            </div>\n        );\n    }\n\n    onMouseEnterIntersection(x: number, y: number) {\n        const coord = xy2coord(x, y);\n        if (this.props.candidates.map(e => e.move).includes(coord)) {\n            this.setState({ candidate: coord });\n        }\n    }\n\n    onMouseLeaveIntersection(x: number, y: number) {\n        if (this.state.candidate) {\n            this.setState({ candidate: undefined });\n        }\n    }\n}\n\ninterface GoIntersectionProps {\n    stone?: string;\n    number?: number;\n    winrate?: string;\n    playouts?: number | string;\n    fillColor?: string;\n    borderWidth?: string;\n    borderColor?: string;\n    backgroundColor?: string;\n    onClick: () => void;\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n}\n\ninterface GoIntersectionState {\n\n}\n\nclass GoIntersection extends React.PureComponent<GoIntersectionProps, GoIntersectionState> {\n    render() {\n        let className = \"go-intersection\";\n        switch (this.props.stone) {\n            case \"B\":\n            className += \" go-intersection-black\";\n            break;\n            case \"W\":\n            className += \" go-intersection-white\";\n            break;\n        }\n        const intersectionStyle: CSSProperties = {\n            backgroundColor: this.props.backgroundColor,\n        }\n        const infoStyle: CSSProperties = {\n            backgroundColor: this.props.fillColor,\n            borderWidth: this.props.borderWidth,\n            borderColor: this.props.borderColor,\n        }\n        return (\n            <div className={className} style={intersectionStyle} onClick={this.props.onClick} onMouseEnter={this.props.onMouseEnter} onMouseLeave={this.props.onMouseLeave} onTouchEnd={() => { this.onTouchEnd(); }}>\n                <div className=\"go-intersection-number\">{this.props.number}</div>\n                <div className=\"go-intersection-info\" style={infoStyle}>\n                    <div>{this.props.winrate}</div>\n                    <div>{typeof this.props.playouts === \"number\" ? shortStringOfInteger(this.props.playouts) : this.props.playouts}</div>\n                </div>\n            </div>\n        );\n    }\n\n    onTouchEnd() {\n        setInterval(this.props.onMouseLeave, 1000);\n    }\n}\n\nexport default GoBoard;\n","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nexport interface LzInfo {\n    move: string,\n    visits: number,\n    winrate: number,\n    pv: string[],\n    prior: number,\n    lcb: number,\n    order: number,\n}\n\nexport interface KataInfo {\n    move: string,\n    visits: number,\n    winrate: number,\n    pv: string[],\n}\n\nexport interface KataInfos {\n    info: any[],\n    ownership: number[],\n}\n\ninterface GtpInputElement extends HTMLFormElement {\n    command: HTMLInputElement\n}\n\nclass Gtp {\n    socket!: WebSocket | any; // any means StdStream\n    buffer: string;\n    lastCommand?: string;\n    resolve?: (line: string) => void;\n    reject?: (line: string) => void;\n    LzAnalyzeHandler?: (infos: LzInfo[]) => void;\n    kataAnalyzeHandler?: (infos: KataInfos) => void;\n\n    constructor(url: string, callback?: () => void, error?: (err: ErrorEvent) => void) {\n        this.buffer = \"\";\n        if (url === \"katago\") {\n            this.socket = window.Module[\"input\"];\n        } else {\n            this.socket = new WebSocket(url);\n        }\n        this.socket.onopen = (event: Event) => {\n            this.socket.onmessage = (event: MessageEvent) => {\n                this.buffer += event.data;\n                const lines = this.buffer.split(\"\\n\");\n                this.buffer = lines.pop()!;\n                for (const line of lines) {\n                    this.process(line);\n                }\n            };\n            if (callback) {\n                callback();\n            }\n        }\n        this.socket.onerror = (err: ErrorEvent) => {\n            console.log(\"onerror\", err);\n            if (error) {\n                error(err);\n            }\n        }\n        if (!(this.socket instanceof WebSocket)) {\n            setTimeout(() => { this.socket.onopen(new CustomEvent(\"open\")); }, 0);\n        }\n        document.addEventListener(\"visibilitychange\", () => {\n            if (document.visibilityState === \"visible\") {\n                this.resume();\n            } else {\n                this.suspend();\n            }\n        }, false);\n    }\n\n    _command(str: string) {\n        this.lastCommand = str;\n        this.socket.send(str + \"\\n\");\n    }\n\n    command(str: string) {\n        return new Promise((res, rej) => {\n            this.LzAnalyzeHandler = undefined;\n            this.resolve = res;\n            this.reject = rej;\n            this._command(str);\n        });\n    }\n\n    async play(turn: string, coord: string): Promise<any> {\n        return await this.command(`play ${turn} ${coord}`);\n    }\n\n    async undo(): Promise<any> {\n        return await this.command(\"undo\");\n    }\n\n    lzAnalyze(interval: number, handler: (infos: LzInfo[]) => void) {\n        this.LzAnalyzeHandler = handler;\n        this._command(`lz-analyze ${interval}`);\n    }\n\n    kataAnalyze(interval: number, handler: (infos: KataInfos) => void) {\n        this.kataAnalyzeHandler = handler;\n        this._command(`kata-analyze ${interval} ownership true`);\n    }\n\n    process(line: string) {\n        if (line.startsWith(\"=\")) {\n            if (this.resolve) {\n                this.resolve(line);\n                this.resolve = undefined;;\n            }\n        } else if (line.startsWith(\"?\")) {\n            if (this.reject) {\n                this.reject(line);\n                this.reject = undefined;;\n            }\n        }\n        if (this.LzAnalyzeHandler) {\n            this.parseLzAnalyze(line);\n        }\n        if (this.kataAnalyzeHandler) {\n            this.parseKataAnalyze(line);\n        }\n    }\n\n    parseLzAnalyze(line: string) {\n        // info move C4 visits 2 winrate 4861 prior 1307 lcb -5139 order 0 pv C4 Q17 info move Q17 visits 2 winrate 4905 prior 1098 lcb -5095 order 1 pv Q17 Q3 info move Q3 visits 2 winrate 4870 prior 1089 lcb -5130 order 2 pv Q3 Q17 info move Q4 visits 2 winrate 4934 prior 915 lcb -5066 order 3 pv Q4 Q17 info move Q16 visits 2 winrate 4940 prior 900 lcb -5060 order 4 pv Q16 Q3 info move D3 visits 0 winrate 4120 prior 853 lcb -5880 order 5 pv D3\n        const regex = /info move ([A-Z]\\d{1,2}) visits (\\d+) winrate (\\d+) prior (-?\\d+) lcb (-?\\d+) order (\\d+) pv ((:? ?[A-Z]\\d{1,2})+)/g;\n        const result = [];\n        let match;\n        while ((match = regex.exec(line)) != null) {\n            result.push({\n                move: match[1],\n                visits: parseInt(match[2]),\n                winrate: parseInt(match[3]) / 10000,\n                prior: parseInt(match[4]),\n                lcb: parseInt(match[5]),\n                order: parseInt(match[6]),\n                pv: match[7].split(\" \")\n            });\n        }\n        this.LzAnalyzeHandler!(result);\n    }\n\n    parseKataAnalyze(line: string) {\n        // info move C16 visits 56 utility -0.0194507 radius 0.00739696 winrate 0.491428 scoreMean -0.478044 scoreStdev 32.3095 prior 0.105269 lcb 0.488786 utilityLcb -0.0268477 order 0 pv C16 D3 R16 Q3 info move Q17 visits 53 utility -0.0205986 radius 0.00789271 winrate 0.490967 scoreMean -0.51843 scoreStdev 32.3086 prior 0.103317 lcb 0.488148 utilityLcb -0.0284914 order 1 pv Q17 R4 C4 D17 info move R16 visits 48 utility -0.0213819 radius 0.00722001 winrate 0.490688 scoreMean -0.558307 scoreStdev 32.284 prior 0.0935492 lcb 0.48811 utilityLcb -0.0286019 order 2 pv R16 D17 Q3 C4 info move Q3 visits 48 utility -0.02044 radius 0.00754151 winrate 0.491073 scoreMean -0.52743 scoreStdev 32.2601 prior 0.0914671 lcb 0.48838 utilityLcb -0.0279815 order 3 pv Q3 C4 C16 Q17 info move D17 visits 46 utility -0.0203694 radius 0.00863686 winrate 0.491095 scoreMean -0.523149 scoreStdev 32.3207 prior 0.0878046 lcb 0.48801 utilityLcb -0.0290062 order 4 pv D17 C4 R4 R16 info move C4 visits 45 utility -0.0197793 radius 0.00917776 winrate 0.491299 scoreMean -0.49066 scoreStdev 32.3245 prior 0.0849676 lcb 0.488021 utilityLcb -0.028957 order 5 pv C4 D17 R4 Q17 info move R4 visits 44 utility -0.0194629 radius 0.00811152 winrate 0.491457 scoreMean -0.490883 scoreStdev 32.3008 prior 0.0829457 lcb 0.488561 utilityLcb -0.0275745 order 6 pv R4 D3 D17 Q17 info move D3 visits 31 utility -0.0191221 radius 0.0111833 winrate 0.491607 scoreMean -0.48426 scoreStdev 32.3926 prior 0.0578495 lcb 0.487613 utilityLcb -0.0303054 order 7 pv D3 R16 Q3 C16 info move Q4 visits 22 utility -0.0124166 radius 0.0190799 winrate 0.494289 scoreMean -0.244886 scoreStdev 32.3341 prior 0.035389 lcb 0.487475 utilityLcb -0.0314966 order 8 pv Q4 C16 Q17 info move D16 visits 21 utility -0.011348 radius 0.0169283 winrate 0.494768 scoreMean -0.224796 scoreStdev 32.3515 prior 0.0329591 lcb 0.488722 utilityLcb -0.0282763 order 9 pv D16 R4 Q17 info move Q16 visits 20 utility -0.0146187 radius 0.0177249 winrate 0.493477 scoreMean -0.347622 scoreStdev 32.3037 prior 0.034737 lcb 0.487147 utilityLcb -0.0323436 order 10 pv Q16 R4 C4 D17 info move D4 visits 18 utility -0.0106007 radius 0.0247917 winrate 0.495063 scoreMean -0.197694 scoreStdev 32.4116 prior 0.026451 lcb 0.486209 utilityLcb -0.0353924 order 11 pv D4 D17 R16 ownership 0.0574604 0.0927184 0.0862007 0.0889222 0.0713715 0.0705342 0.0663168 0.0699454 0.0696961 0.0703135 0.0707498 0.0720875 0.0683848 0.0697193 0.0657052 0.0811097 0.0803288 0.0891219 0.0589881 0.09508 0.0887696 0.0856517 0.0567618 0.0538765 0.0454831 0.037413 0.0424316 0.0418428 0.0414332 0.0427052 0.0438007 0.0401999 0.0443078 0.04858 0.0488899 0.0744198 0.0782437 0.0795875 0.0927124 0.0970239 0.068805 0.0359063 0.027807 0.040289 0.0323884 0.0359301 0.0319725 0.0286396 0.0314628 0.0330162 0.0307161 0.0350543 0.0235283 0.020687 0.0460025 0.073326 0.0802772 0.102314 0.0730797 0.0559703 0.0428388 0.0478558 0.0374339 0.0321411 0.0350915 0.032562 0.0320581 0.0322501 0.0338105 0.0301837 0.029372 0.0364939 0.0338301 0.0170987 0.0471682 0.0860232 0.0806405 0.06963 0.0410239 0.0474705 0.0264108 0.028095 0.0277513 0.0269129 0.025512 0.0257056 0.0253849 0.0268678 0.0262896 0.0218693 0.0223549 0.0386803 0.0254255 0.0511993 0.0714695 0.0758416 0.0510583 0.039525 0.0360652 0.0254357 0.024569 0.0223601 0.0146071 0.0127407 0.0131719 0.0130609 0.0145692 0.020976 0.0232113 0.0236705 0.0341295 0.038488 0.0405238 0.0703722 0.0724104 0.0408933 0.0345678 0.033456 0.0273286 0.0214489 0.0109052 0.00227355 1.36716e-05 7.0059e-05 -0.000410544 0.00066663 0.00918381 0.0199694 0.0284545 0.0308396 0.0304586 0.0345143 0.0668094 0.072015 0.0414706 0.0365848 0.0383315 0.0287511 0.014852 0.00129122 -0.00670995 -0.0096296 -0.00890338 -0.009229 -0.00681303 0.00073803 0.0125068 0.0282436 0.033793 0.0327075 0.0415581 0.0722434 0.0677752 0.0390562 0.0333236 0.0353017 0.0260784 0.0115204 -0.0021702 -0.0113931 -0.0153548 -0.0147816 -0.014332 -0.0103502 -0.00193408 0.0102372 0.0246196 0.0313203 0.0286652 0.0404499 0.071719 0.0652687 0.0371737 0.0271852 0.0320029 0.0244574 0.0101729 -0.00306306 -0.0122747 -0.0168854 -0.0162893 -0.0162496 -0.0113587 -0.00237764 0.00981343 0.0236747 0.0300972 0.0250575 0.0373618 0.071067 0.0634167 0.0371166 0.0251066 0.0275254 0.0212085 0.00748802 -0.00544358 -0.0136066 -0.0178959 -0.0181945 -0.0177597 -0.0128457 -0.00337375 0.00914089 0.0226917 0.0299255 0.0269413 0.0340216 0.0690287 0.0610828 0.0350292 0.0234277 0.0245448 0.0195385 0.00625186 -0.00509413 -0.011918 -0.0136773 -0.0126529 -0.0125938 -0.00954261 -0.00163155 0.0104468 0.0230677 0.0297651 0.0248561 0.0325079 0.0667663 0.0530989 0.0241485 0.0167402 0.0170874 0.0144973 0.0102617 0.00225149 -0.00486142 -0.00583227 -0.00427596 -0.00443261 -0.00260952 0.00667355 0.0165172 0.0215436 0.0231393 0.0177754 0.0248205 0.0616455 0.0496837 0.0235134 0.0107289 0.0131149 0.00576788 0.0106886 0.0100019 0.00467538 0.00352945 0.00487139 0.00469349 0.00734111 0.014891 0.0163271 0.0148882 0.0227564 0.0179868 0.0292976 0.0605091 0.0454176 0.0215302 -0.00957254 0.00772825 0.00449392 0.00775453 0.013559 0.0158508 0.0147453 0.0162791 0.0170412 0.0195928 0.0195486 0.0157745 0.0127525 0.0227294 0.0123397 0.0336789 0.0560846 0.0524011 0.00537971 -0.0367772 0.0201121 0.00255268 0.00633342 0.0112068 0.0194867 0.0195896 0.0213024 0.021994 0.0238675 0.0197127 0.0185881 0.0267457 0.0271527 0.00493118 0.0321386 0.0680206 0.0320382 0.0248312 -0.0121598 -0.0560937 -0.016586 0.0033388 0.010258 0.0191786 0.0191341 0.0169894 0.0206722 0.0221256 0.0157605 0.0197785 0.0122782 -0.00640326 0.0215207 0.0570617 0.0569199 0.0235893 0.0244588 0.0171742 -0.00940123 0.00497656 0.0136249 0.0109796 0.0211825 0.0241471 0.0261304 0.0284791 0.0278052 0.0240433 0.0307363 0.0356951 0.0270279 0.0523358 0.0552047 0.0552847 -0.00718682 0.0239468 0.0142311 0.0338551 0.0278807 0.0416977 0.0494086 0.0593436 0.0604753 0.0625834 0.0626572 0.0633467 0.0566236 0.0559152 0.0495887 0.0620285 0.051852 0.0538323 0.0218319\n        const result: KataInfos = {\n            info: [],\n            ownership: []\n         };\n         if (!line.includes(\"info\")) {\n            this.kataAnalyzeHandler!(result);\n            return;\n         }\n         const [infos, ownership] = line.trim().split(\"ownership\");\n         const infoStrs = infos.trim().split(\"info\");\n         infoStrs.shift(); // 最初は空文字列\n         for (const infoStr of infoStrs) {\n            const items = infoStr.trim().split(\" \");\n            const info: any = {};\n            while (items.length > 1) {\n                const item = items.shift()!;\n                switch (item) {\n                    case \"move\":\n                    info[item] = items.shift();\n                    break;\n                    case \"visits\":\n                    info[item] = parseInt(items.shift()!);\n                    break;\n                    case \"pv\":\n                    info[item] = [...items];\n                    items.splice(0);\n                    break;\n                    default:\n                    info[item] = parseFloat(items.shift()!);\n                    break;\n                }\n            }\n            if (\"move\" in info && \"visits\" in info && \"winrate\" in info && \"pv\" in info) {\n                result.info.push(info as KataInfo);\n            } else {\n                console.log(info);\n                console.log(line);\n            }\n        }\n        if (ownership != null) {\n            result.ownership = ownership.trim().split(\" \").map(parseFloat);\n        };\n        this.kataAnalyzeHandler!(result);\n    }\n\n    suspend() {\n        this.socket.send(\"\\n\");\n    }\n\n    resume() {\n        if (this.lastCommand) {\n            this._command(this.lastCommand);\n        }\n    }\n}\n\nexport default Gtp;","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport React from \"react\";\nimport SituationBar from \"./SituationBar\";\nimport GoBoard from \"./GoBoard\";\nimport GoPosition, { BLACK, xy2coord, GoMove } from \"./GoPosition\";\nimport Gtp, { KataInfo } from \"./Gtp\";\n\nfunction appendScript(URL: string, onload: (() => void) | null = null) {\n\tvar el = document.createElement('script');\n    el.src = URL;\n    el.onload = onload;\n\tdocument.body.appendChild(el);\n}\n\nfunction updateMessage(str: string, color: string = \"black\") {\n    const dom = document.getElementById(\"message\")!;\n    dom.innerText = str;\n    dom.style.color = color;\n}\n\ndeclare var FS: any;\n\ndeclare global {\n    interface Window {\n        clipboardData?: any;\n        goAI: GoAI;\n        Module: any;\n    }\n}\n\ninterface Props {\n    gtp: string;\n}\n\ninterface State {\n    percent: number;\n    black: string;\n    white: string;\n    model: GoPosition;\n    history: GoMove[];\n    candidates: KataInfo[];\n    ownership: number[];\n}\n\nclass GoAI extends React.Component<Props, State> {\n    size: number;\n    byoyomi: number;\n    gtp!: Gtp;\n    constructor(props: Props) {\n        super(props)\n        this.size = 19;\n        this.byoyomi = 3;\n        this.state = {\n            percent: 50,\n            black: \"\",\n            white: \"\",\n            model: new GoPosition(this.size, 0),\n            history: [],\n            candidates: [],\n            ownership: []\n        }\n        document.getElementById(\"sgf\")!.addEventListener(\"paste\", async (e) => {\n            const sgf = (e.clipboardData || window.clipboardData).getData(\"text\");\n            const file = \"tmp.sgf\";\n            FS.writeFile(file, sgf);\n            await this.gtp.command(`loadsgf ${file}`);\n            const model = GoPosition.fromSgf(sgf);\n            this.setState({ model: model });\n            this.kataAnalyze();\n        }, false);\n        if (this.props.gtp === \"katago\") {\n            if (typeof SharedArrayBuffer === \"undefined\") {\n                updateMessage(\"SharedArrayBuffer, which is necessary for KataGo, is not available. Trying to connect localhost websocket server...\", \"yellow\");\n                this.start(\"ws://localhost:5001\");\n            } else {\n                window.goAI = this; // KataGoが準備できたら(pre_pre.js) startをコールする\n                appendScript(\"pre_pre.js\", () => {\n                    appendScript(\"katago.js\");\n                });\n            }\n        } else {\n            this.start(this.props.gtp);\n        }\n    }\n\n    start(url: string) {\n        try {\n            this.gtp = new Gtp(url, () => {\n                this.kataAnalyze();\n            }, (err) => {\n                updateMessage(`failed to connect ${(err?.target as WebSocket).url}`, \"red\");\n            });\n        } catch(e) {\n            updateMessage(e.toString(), \"red\");\n        }\n    }\n\n    render() {\n        const size = `${Math.min(window.innerWidth, window.innerHeight)}px`;\n        return (\n            <div>\n                <SituationBar\n                    width={size}\n                    blackPercent={this.state.percent}\n                    blackInfo={this.state.black}\n                    whiteInfo={this.state.white}\n                />\n                <GoBoard\n                    width={size}\n                    height={size}\n                    w={this.size}\n                    h={this.size}\n                    candidates={this.state.candidates}\n                    model={this.state.model}\n                    onClickIntersection={(x, y) => {\n                        if (this.state.history[this.state.history.length - 1]?.point === this.state.model.xyToPoint(x, y)) {\n                            this.undo();\n                        } else {\n                            this.play(x, y);\n                        }\n                    }}\n                />\n            </div>\n        );\n    }\n\n    lzAnalyze() {\n        this.gtp.lzAnalyze(100, result => {\n            const first = result[0];\n            const blackWinrate = (this.state.model.turn === BLACK ? first.winrate : 1 - first.winrate) * 100;\n            this.setState({\n                candidates: result,\n                percent: blackWinrate,\n                black: `${blackWinrate.toFixed(1)}%`,\n                white: `${(100 - blackWinrate).toFixed(1)}%`\n            });\n        });\n    }\n\n    kataAnalyze() {\n        this.gtp.kataAnalyze(100, result => {\n            if (result.info.length === 0) {\n                return;\n            }\n            const first = result.info[0];\n            const blackWinrate = (this.state.model.turn === BLACK ? first.winrate : 1.0 - first.winrate) * 100;\n            const blackScore = (this.state.model.turn === BLACK ? first.scoreMean : 1.0 - first.scoreMean).toFixed(1);\n            const scoreStdev = first.scoreStdev.toFixed(1);\n            let black;\n            let white;\n            if (blackWinrate >= 50) {\n                black = `${blackWinrate.toFixed(1)}%(${blackScore}±${scoreStdev})`;\n                white = `${(100 - blackWinrate).toFixed(1)}%`;\n            } else {\n                black = `${blackWinrate.toFixed(1)}%`;\n                white = `${(100 - blackWinrate).toFixed(1)}%(${-blackScore}±${scoreStdev})`;\n            }\n            this.setState({\n                candidates: result.info,\n                ownership: result.ownership,\n                percent: blackWinrate,\n                black,\n                white \n            });\n        });\n    }\n\n    async play(x: number, y: number) {\n        try {\n            const turn = this.state.model.turn;\n            this.setState((state, props) => {\n                const move = state.model.play(state.model.xyToPoint(x, y));\n                if (move != null) {\n                    state.history.push(move);\n                }\n                return {\n                    model: state.model,\n                    history: state.history,\n                    candidates: [],\n                    ownership: []\n                };\n            });\n            await this.gtp.play(turn === BLACK ? \"black\" : \"white\", xy2coord(x, y));\n            this.kataAnalyze();\n        } catch (e) {\n            console.log(e);\n        }\n    }\n\n    async undo() {\n        try {\n            this.setState((state, props) => {\n                const move = state.history.pop();\n                if (move != null) {\n                    state.model.undoPlay(move);\n                }\n                return {\n                    model: state.model,\n                    history: state.history,\n                    candidates: [],\n                    ownership: []\n                };\n            });\n            await this.gtp.undo();\n            this.kataAnalyze();\n        } catch (e) {\n            console.log(e);\n        }\n    }\n}\n\nexport default GoAI;\n","import React from \"react\";\nimport GoAI from \"./GoAI\";\n\nconst App = () => {\n  let gtp = \"katago\";\n  if (window.location.search.startsWith(\"?\")) {\n    const assigns = window.location.search.substr(1).split(\"&\");\n    for (const assign of assigns) {\n      const tokens = assign.split(\"=\");\n      if (tokens[0] === \"gtp\") {\n        gtp = tokens[1];\n      }\n    }\n  }\n  return (\n    <div>\n      <GoAI gtp={gtp} />\n    </div>\n  );\n};\n\nexport default App;\n","/**\n * @preserve Copyright 2019 ICHIKAWA, Yuji (New 3 Rs)\n */\n\nimport * as serviceWorker from './serviceWorker';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nrender(<App />, document.getElementById('app-container'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}